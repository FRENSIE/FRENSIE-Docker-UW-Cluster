# Configure the Dockerfile
CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/Dockerfile.in ${CMAKE_CURRENT_BINARY_DIR}/Dockerfile @ONLY)

# Configure the build script
CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/build-deps.sh.in ${CMAKE_CURRENT_BINARY_DIR}/build-deps.sh @ONLY)

# Configure the run script
CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/run-deps.sh.in ${CMAKE_CURRENT_BINARY_DIR}/run-deps.sh @ONLY)

ADD_CUSTOM_COMMAND(OUTPUT ${BUILD_DEPS_SUCCESS_FILE}
  WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}
  COMMAND ./build-deps.sh)

ADD_CUSTOM_TARGET(${BUILD_DEPS_TARGET} ALL
  DEPENDS ${BUILD_DEPS_SUCCESS_FILE} ${BASE_TARGET})
